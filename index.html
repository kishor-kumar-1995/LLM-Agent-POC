<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LLM Agent POC</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
  <h2 class="mb-3">üßë‚Äçüíª LLM Agent POC</h2>

  <!-- Conversation Window -->
  <div id="chat" class="border rounded p-3 bg-white mb-3" style="height:300px;overflow-y:auto"></div>

  <!-- Input + Send -->
  <div class="input-group mb-3">
    <input id="userInput" type="text" class="form-control" placeholder="Type your message...">
    <button class="btn btn-primary" onclick="sendMessage()">Send</button>
  </div>

  <!-- Alerts -->
  <div id="alerts"></div>
</div>

<script>
// --- Conversation state ---
let messages = [];

// --- Append message to chat window ---
function appendMessage(sender, text) {
  const div = document.createElement("div");
  div.innerHTML = `<b>${sender}:</b> ${text}`;
  document.getElementById("chat").appendChild(div);
  document.getElementById("chat").scrollTop = 9999;
}

// --- Handle user input ---
async function sendMessage() {
  const input = document.getElementById("userInput");
  const text = input.value.trim();
  if (!text) return;
  appendMessage("You", text);
  input.value = "";

  try {
    // Call your backend 2
    const res = await fetch("https://llm-agent-backend-2.onrender.com/api/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question: text })
    });

    const data = await res.json();
    appendMessage("Agent", data.answer || JSON.stringify(data));
  } catch (err) {
    showError(err.message);
  }
}

// --- Error handler ---
function showError(msg) {
  const alert = `<div class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong>Error:</strong> ${msg}
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>`;
  document.getElementById("alerts").innerHTML = alert;
}
</script>
</body>
</html>
